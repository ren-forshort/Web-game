<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cửa hàng Hoi AE KHTN</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <!-- Header -->
    <header>
        <div class="brand-container" onclick="switchPage('store', document.querySelector('.nav-link'))">
            <img src="/Images/Logo.png" alt="Logo" class="brand-logo">
            <div class="brand-text-col">
                <span class="brand-small">Hoi AE</span>
                <span class="brand-main">KHTN</span>
                <span class="brand-small">Store</span>
            </div>
        </div>
        <nav class="nav-links">
            <a href="#" class="nav-link active" onclick="switchPage('store', this)">Cửa hàng</a>
            <a href="#" class="nav-link" onclick="switchPage('community', this)">Cộng đồng</a>
            <a href="#" class="nav-link" onclick="switchPage('upload', this)">Đăng game</a>
            <a href="#" class="nav-link" onclick="switchPage('support', this)">Hỗ trợ</a>
            <a href="#" class="nav-link" onclick="switchPage('report', this)">Báo cáo</a>
        </nav>
        <div class="header-actions">
            <div class="search-container">
                <i data-lucide="search" class="search-icon"></i>
                <input type="text" class="search-input" placeholder="tìm kiếm" id="search-input">
            </div>
        </div>
    </header>

    <!-- Main Store View -->
    <div id="store-view" class="container">
        <!-- Featured Carousel -->
        <section class="featured-section" id="featured-carousel">
            <!-- Injected by JS -->
        </section>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">Thể loại</div>
                <div class="filter-option active" onclick="filterByGenre('All')">Tất cả sản phẩm</div>
                <div class="filter-option" onclick="filterByGenre('Hành động')">Hành động</div>
                <div class="filter-option" onclick="filterByGenre('Nhập vai (RPG)')">Nhập vai (RPG)</div>
                <div class="filter-option" onclick="filterByGenre('Chiến thuật')">Chiến thuật</div>
                <div class="filter-option" onclick="filterByGenre('Phiêu lưu')">Phiêu lưu</div>
                <div class="filter-option" onclick="filterByGenre('Mô phỏng')">Mô phỏng</div>
                <div class="filter-option" onclick="filterByGenre('Thể thao')">Thể thao</div>
            </div>
        </aside>

        <!-- Main Store Content -->
        <main>
            <div class="store-header">
                <div class="section-title">Đang xem <span id="current-genre">Tất cả trò chơi</span></div>
                <div style="font-size: 12px; color: var(--text-muted);">
                    Sắp xếp theo: <span style="color:white; cursor:pointer;">Bán chạy nhất</span>
                </div>
            </div>

            <div class="games-grid" id="games-grid">
                <!-- Games injected here -->
            </div>
        </main>
    </div>

    <!-- Upload Game View -->
    <div id="upload-view" class="report-view">
        <div class="report-header">
            <h1 class="section-title" style="font-size: 24px;">Đăng game mới</h1>
            <p style="color: var(--text-muted); margin-top: 10px;">
                Vui lòng điền đầy đủ thông tin bên dưới để chia sẻ game của bạn.
            </p>
        </div>
        <form class="report-form" onsubmit="submitGame(event)">
            <!-- 1. Tên nhà phát triển / công ty -->
            <div class="form-group">
                <label class="form-label">Tên nhà phát triển / công ty <span style="color:red">*</span></label>
                <input type="text" id="game-dev" class="form-input" placeholder="Ví dụ: Indie Dev Team" required>
            </div>

            <!-- 2. Email liên hệ -->
            <div class="form-group">
                <label class="form-label">Email liên hệ <span style="color:red">*</span></label>
                <input type="email" id="game-email" class="form-input" placeholder="contact@example.com" required>
            </div>

            <!-- 3. Tên game -->
            <div class="form-group">
                <label class="form-label">Tên game <span style="color:red">*</span></label>
                <input type="text" id="game-title" class="form-input" placeholder="Nhập tên trò chơi" required>
            </div>
            
            <!-- 4. Mô tả ngắn -->
            <div class="form-group">
                <label class="form-label">Mô tả ngắn <span style="color:red">*</span></label>
                <textarea id="game-desc" class="form-textarea" placeholder="Giới thiệu sơ lược về nội dung và cách chơi..." style="min-height: 100px;" required></textarea>
            </div>

            <!-- 5. Link tải game -->
            <div class="form-group">
                <label class="form-label">Link tải game (Google Drive, Dropbox, Itch.io...) <span style="color:red">*</span></label>
                <input type="url" id="game-link" class="form-input" placeholder="https://..." required>
            </div>

            <!-- 6. Link video demo -->
            <div class="form-group">
                <label class="form-label">Link video demo (YouTube, Vimeo...)</label>
                <input type="url" id="game-demo" class="form-input" placeholder="https://youtube.com/watch?v=...">
            </div>

            <!-- 7. Thể loại game -->
            <div class="form-group">
                <label class="form-label">Thể loại game <span style="color:red">*</span></label>
                <select id="game-genre" class="form-select">
                    <option value="Hành động">Hành động</option>
                    <option value="Nhập vai (RPG)">Nhập vai (RPG)</option>
                    <option value="Chiến thuật">Chiến thuật</option>
                    <option value="Phiêu lưu">Phiêu lưu</option>
                    <option value="Mô phỏng">Mô phỏng</option>
                    <option value="Thể thao">Thể thao</option>
                    <option value="Khác">Khác</option>
                </select>
            </div>

            <!-- 8. Hình minh họa -->
            <div class="form-group">
                <label class="form-label">Link hình minh họa (URL) <span style="color:red">*</span></label>
                <input type="url" id="game-image" class="form-input" placeholder="https://example.com/image.png" required>
            </div>

            <!-- 9. Ghi chú thêm -->
            <div class="form-group">
                <label class="form-label">Ghi chú thêm</label>
                <textarea id="game-notes" class="form-textarea" placeholder="Hướng dẫn cài đặt đặc biệt, cấu hình yêu cầu, v.v..." style="min-height: 80px;"></textarea>
            </div>

            <button type="submit" class="btn-submit">Đăng game</button>
        </form>
    </div>

    <!-- Community Page View (With Database) -->
    <div id="community-view" class="community-container">
        <div class="report-header">
            <h1 class="section-title" style="font-size: 24px;">Cộng đồng</h1>
            <p style="color: var(--text-muted); margin-top: 10px;">
                Chia sẻ ý kiến và thảo luận cùng mọi người.
            </p>
        </div>

        <div class="post-creator">
            <form id="post-form" class="report-form">
                <div class="form-group">
                    <label class="form-label">Tên hiển thị</label>
                    <input type="text" id="post-author" class="form-input" placeholder="Tên của bạn" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Nội dung</label>
                    <textarea id="post-content" class="form-textarea" placeholder="Bạn đang nghĩ gì?" style="min-height: 100px;" required></textarea>
                </div>
                <button type="submit" class="btn-submit">Đăng bài</button>
            </form>
        </div>

        <div id="community-feed" class="post-feed">
            <div class="loading-text">Đang tải bài viết...</div>
        </div>
    </div>

    <!-- Support Page View -->
    <div id="support-view" class="report-view" style="display: none;">
        <div class="report-header">
            <h1 class="section-title" style="font-size: 24px;">Trung tâm hỗ trợ</h1>
            <p style="color: var(--text-muted); margin-top: 10px;">
                Chào mừng bạn đến với Cửa hàng Hoi AE KHTN. Dưới đây là hướng dẫn cơ bản để bạn bắt đầu.
            </p>
        </div>
        
        <div class="support-content" style="color: var(--text-main); line-height: 1.6;">
            <div style="margin-bottom: 25px;">
                <h3 style="color: var(--accent-blue); margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                    <i data-lucide="search" size="20"></i> 1. Tìm kiếm trò chơi
                </h3>
                <p>Bạn có thể tìm kiếm trò chơi yêu thích bằng cách nhập tên vào thanh tìm kiếm ở góc trên bên phải hoặc lọc theo thể loại ở thanh menu bên trái.</p>
            </div>

            <div style="margin-bottom: 25px;">
                <h3 style="color: var(--accent-blue); margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                    <i data-lucide="mouse-pointer" size="20"></i> 2. Xem chi tiết
                </h3>
                <p>Nhấp vào bất kỳ thẻ game nào để mở cửa sổ chi tiết. Tại đây, bạn có thể xem mô tả, ảnh chụp màn hình (gallery) và thông tin phát hành.</p>
            </div>

            <div style="margin-bottom: 25px;">
                <h3 style="color: var(--accent-blue); margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                    <i data-lucide="download" size="20"></i> 3. Tải xuống
                </h3>
                <p>Trong cửa sổ chi tiết, nhấn vào nút <strong>"Tải xuống"</strong> để truy cập đường dẫn tải game (thường là Itch.io hoặc GitHub). Tất cả game trên store đều miễn phí.</p>
            </div>

            <div style="margin-bottom: 25px;">
                <h3 style="color: var(--accent-blue); margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                    <i data-lucide="flag" size="20"></i> 4. Báo cáo vấn đề
                </h3>
                <p>Nếu gặp lỗi hoặc link hỏng, vui lòng truy cập trang <strong>"Báo cáo"</strong> trên thanh menu và gửi thông tin cho chúng tôi.</p>
            </div>
        </div>
    </div>

    <!-- Report Page View -->
    <div id="report-view" class="report-view">
        <div class="report-header">
            <h1 class="section-title" style="font-size: 24px;">Báo cáo vấn đề</h1>
            <p style="color: var(--text-muted); margin-top: 10px;">
                Hãy cho chúng tôi biết về lỗi game, nội dung không phù hợp hoặc các vấn đề khác mà bạn gặp phải.
            </p>
        </div>
        <form class="report-form" onsubmit="submitReport(event)">
            <div class="form-group">
                <label class="form-label">Tên hiển thị</label>
                <input type="text" id="report-name" class="form-input" placeholder="Nhập tên của bạn" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Email liên hệ</label>
                <input type="email" id="report-email" class="form-input" placeholder="email@example.com" required>
            </div>

            <div class="form-group">
                <label class="form-label">Loại vấn đề</label>
                <select id="report-type" class="form-select">
                    <option value="bug">Lỗi game (Bug/Glitch)</option>
                    <option value="content">Nội dung không phù hợp</option>
                    <option value="download">Lỗi tải xuống</option>
                    <option value="other">Khác</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Mô tả chi tiết</label>
                <textarea id="report-desc" class="form-textarea" placeholder="Vui lòng mô tả chi tiết vấn đề bạn gặp phải..." required></textarea>
            </div>

            <script type="module" src="script.js"></script>
            updateModalGallery();
        }

        window.prevModalSlide = function() {
            if (!selectedGame) return;
            const images = selectedGame.gallery || [selectedGame.image];
            currentModalImageIndex = (currentModalImageIndex - 1 + images.length) % images.length;
            updateModalGallery();
        }

        window.closeModal = function() {
            modal.classList.remove('open');
            document.body.style.overflow = 'auto';
        }

        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });

        window.switchPage = function(page, element) {
            document.getElementById('store-view').style.display = 'none';
            document.getElementById('report-view').style.display = 'none';
            document.getElementById('support-view').style.display = 'none';
            document.getElementById('community-view').style.display = 'none';
            document.getElementById('upload-view').style.display = 'none';
            
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            
            if(page === 'store') {
                document.getElementById('store-view').style.display = 'grid';
            } else if (page === 'report') {
                document.getElementById('report-view').style.display = 'block';
            } else if (page === 'support') {
                document.getElementById('support-view').style.display = 'block';
            } else if (page === 'community') {
                document.getElementById('community-view').style.display = 'block';
            } else if (page === 'upload') {
                document.getElementById('upload-view').style.display = 'block';
            }
            
            if(element) element.classList.add('active');
            if (typeof lucide !== 'undefined') lucide.createIcons();
        }

    </script>
</body>
</html>